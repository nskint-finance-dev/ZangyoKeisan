# 残業計算 仕様書
## 概要
Mospの勤怠記録から法律に沿った残業時間を正確に計算する。

残業時間は下記２つの合計時間とする。
 1. １日に８時間を超過して勤務した時間
 2. １週間に４０時間を超えて勤務した時間（「1.」の時間を除く）

## 詳細
### １日の残業時間を計算
#### 処理対象日の判断
当該日が下記の日でない場合、処理を行う。
 - 法定休日（日曜日）
 - 有給休暇
 - 代休
 - 所定休日（土曜日、祝日）

 #### １日あたりの残業時間算出
１日の勤務時間のうち**8時間**を超過した時間を残業時間として算出する。
なお、勤務先の業務時間が8時間でない場合も、残業時間の算出においては考慮しない。

```
１日の残業時間 = １日の勤務時間 - 8時間
```

#### １週間あたりの勤務時間算出
１週間あたりの残業時間を計算するためには、１週間の合計勤務時間を算出する必要がある。

このため、当該日の勤務時間を１週間あたりの勤務時間に加算する。
```
１週間の合計勤務時間 += 当該日の勤務時間
```


### １週間の残業時間を計算
月曜から土曜の合計勤務時間のうち**40時間**を超えた時間から、上記の処理で算出した月曜から土曜それぞれの日の合計残業時間を減算した時間を、１週間の残業時間として算出する。
基本的には、土曜日の勤務時間が該当する。
```
１週間の残業時間 = 月曜から土曜の合計勤務時間 - 40時間 - 月曜から土曜の合計残業時間
```

### １ヶ月の残業時間を計算
１日の残業時間と１週間の残業時間を合計し、週あたりの残業時間とする。
```
週あたりの残業時間 = １日の残業時間 + １週間の残業時間
```

### １ヶ月の残業時間を計算
当月の週あたりの残業時間を合計し、合計残業時間として算出する。

## 備考
### 日曜日の勤務時間
日曜日の勤務時間は全て休日勤務とし、**残業時間の計算には含めない**。

 ### 考慮対象外
 下記の事項は残業時間計算において考慮していない。
 #### 月をまたぐ週の残業時間
 月初、月末が月曜日始まり、日曜日終わりでない場合においても、１週間ごとに残業時間を計算することに法律上変わりはない。

 しかし、勤怠記録は当月分しかないため、月初、月末の残業時間は正確に計算できない。

 ##### 月末、月初の残業時間を正確に計算できない例
 |月|火|水|木|金|土|日|
 |-|-|-|-|-|-|-|
 |3/30|31|4/1|2|3|4|5|
 |10|10|10|10|10|10|10|
 |対象外|対象外|対象|対象|対象|対象|対象|

 上記のようなカレンダーで、4月分の残業時間を計算する場合、4/1～4/5の残業時間は勤怠簿に存在するので処理できる。
 しかし、3/30、31は勤怠簿に存在しないので、処理できない。このため、１週間あたりの残業時間を正確に計算できない。
